{
    "exports": {
        "default": "e=>{var t;let n,{listing:a,guildId:v,groupListingId:I,analyticsLocation:_,showBenefitsFirst:N,onComplete:A,forcesTransitionToGuild:y}=e,x=null==a?void 0:a.subscription_plans[0],O=null==a?void 0:a.application_id,R=null==x?void 0:x.id,M=(null==a?void 0:a.published)===!0,L=null==x?void 0:x.sku_id,P=(0,r.useStateFromStores)([p.default],()=>null!=R?p.default.get(R):null),b=(0,h.useApplication)(O),j=(0,h.useSubscriptionListingsForGroup)(I,{includeSoftDeleted:!0}),U=j.map(e=>e.subscription_plans[0].id),{analyticsLocations:D}=(0,d.default)(),{activeSubscription:k,activeEntitlement:w}=(0,h.useActiveSubscriptionListingForApplication)(O,v),F=(0,h.useEligibleApplicationSubscriptionGuilds)(O,v),G=(0,c.default)(),B=null!=a&&(0,E.isApplicationUserSubscription)(a.sku_flags),H=null!=w&&w.userId===(null===(t=m.default.getCurrentUser())||void 0===t?void 0:t.id),V=null==w||H,K=null==w||U.length>1,W=null!=v||F.length>0,Y=B&&H,z=null!=P&&null!=b&&V&&K&&(W||B)&&!Y;V?W?Y&&null!=P&&(n=T.default.Messages.APPLICATION_USER_SUBSCRIPTION_ALREADY_SUBSCRIBED.format({tierName:P.name})):n=T.default.Messages.APPLICATION_SUBSCRIPTION_NO_GUILD_AVAILABLE:n=T.default.Messages.APPLICATION_SUBSCRIPTIONS_CANNOT_MANAGE_SUBSCRIPTION,i.useEffect(()=>{M&&null!=L&&G&&o.default.wait(()=>{(0,u.fetchSubscriptionPlansForSKU)(L)})},[M,L,G]);let Z=i.useCallback(()=>{s(null!=a,\"No subscription listing\"),s(null!=b,\"No application\"),s(null!=x,\"No subscription plan\"),s(M,\"Cannot purchase this unpublished plan\");let e=()=>{(0,f.openApplicationSubscriptionPaymentModal)({activeSubscription:k,analyticsSubscriptionType:C.SubscriptionTypes.APPLICATION,analyticsLocations:D,analyticsLocation:_,renderHeader:(e,t,n)=>(0,l.jsx)(g.PurchaseHeader,{step:n,onClose:()=>t(!1)}),initialPlanId:x.id,skuId:x.sku_id,guildId:v,eligibleApplicationSubscriptionGuilds:F,planGroup:U,listing:a,application:b,showBenefitsFirst:N,onComplete:A,forcesTransitionToGuild:y})};!W&&B?(0,S.confirmNoSharedServerSubscribeWarningModal)({application:b,onConfirm:e,onCancel:()=>{}}):e()},[M,a,x,U,b,v,W,B,D,_,k,N,F,A,y]);return{openModal:Z,canOpenModal:z,cannotOpenReason:n}}"
    }
}