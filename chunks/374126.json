{
    "exports": {
        "default": "class a{constructor(e=r,t=100){this.logger=e,this.defaultRetryAfter=t,this.queue=new(i()),this.timeout=null,this.draining=!1}enqueue(e,t,n){this.queue.push({message:e,success:t,logId:n}),this._drainIfNecessary()}get length(){return this.queue.length}_drainIfNecessary(){if(null!==this.timeout||0===this.queue.length||!0===this.draining)return;this.draining=!0;let e=this.queue.shift(),{message:t,success:n,logId:s}=e;this.logger.log(`Draining message from queue LogId:${s} QueueLength: ${this.queue.length}`),this.drain(t,(t,i)=>{if(this.logger.log(`Finished draining message from queue LogId:${s} QueueLength: ${this.queue.length}`),this.draining=!1,null==t){setImmediate(()=>this._drainIfNecessary());try{n(i)}catch(e){this.logger.error(\"\",e)}}else{let n=t.retryAfter??this.defaultRetryAfter;this.logger.info(`Rate limited. Delaying draining of queue for ${n} ms. LogId:${s} QueueLength: ${this.queue.length}`),this.timeout=setTimeout(()=>{this.queue.unshift(e),this.timeout=null,this._drainIfNecessary()},n)}})}}"
    }
}