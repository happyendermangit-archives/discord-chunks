{
    "exports": {
        "createInitialState": "function u(){return{query:null,selectedIndex:null,isVisible:!1,didInitialQuery:!1}}",
        "default": "class d extends i.EventEmitter{constructor(e){super(),this.props=e,this.state=u()}updateProps(e){let t=this.props.focused!==e.focused,n=this.props.channel.id!==e.channel.id||this.props.activeCommandOption!==e.activeCommandOption,i=!this.state.didInitialQuery||this.props.currentWord!==e.currentWord||this.props.currentWordIsAtStart!==e.currentWordIsAtStart||this.props.textValue!==e.textValue||this.props.optionText!==e.optionText;if(this.props=e,n||i)this.updateResults(i,n),!this.state.didInitialQuery&&(this.state={...this.state,didInitialQuery:!0});else if(t){let e=this.state.query;this.setState({isVisible:null!=e&&this.shouldShow(e.resultCount,e.isLoading,e.typeInfo)})}}setSelectedIndex(e){this.setState({selectedIndex:e})}onTabOrEnter(e){if(!this.state.isVisible)return!1;if(null==this.state.selectedIndex){let t=this.state.query?.typeInfo.focusMode;return!e&&(t===r.FocusMode.MANUAL||t===r.FocusMode.AUTO_WHEN_FILTERED)&&(this.setSelectedIndex(0),!0)}return this.selectResult(this.state.selectedIndex,e,!0)}onMoveSelection(e){if(!this.state.isVisible)return!1;if(e<0?this.props.navigator.focusPreviousItem():e>0&&this.props.navigator.focusNextItem(),null!=this.state.selectedIndex&&this.state.query?.type===r.AutocompleteOptionTypes.COMMANDS){let e=this.state.query.results.commands?.[this.state.selectedIndex];null!=e&&a.setPreferredCommandId(this.props.channel.id,e.id)}return!0}onMaybeShowAutocomplete(){this.emit(\"update\")}onHideAutocomplete(){null!=this.state.query&&this.setState({isVisible:!1})}onResultHover(e){this.props.navigator.setFocus(null),this.setSelectedIndex(null)}onResultClick(e){this.selectResult(e,!0)}clearQuery(){this.setState({query:null,isVisible:!1,selectedIndex:null})}queryResults(){this.updateResults()}isVisible(){return this.state.isVisible}updateResults(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==this.props.editorRef.current)return;let n=(0,o.getOptions)(this.props),i=(0,o.findMatchingAutocompleteType)({channel:this.props.channel,guild:this.props.guild,options:n,currentWord:this.props.currentWord,currentWordIsAtStart:this.props.currentWordIsAtStart,textValue:this.props.textValue,optionText:this.props.optionText}),a=n.commands!==r.CommandMode.DISABLED?(0,o.findCommandOptionAutocompleteType)(this.props.activeCommandOption,this.props.currentWord):null;if(null==i&&null!=a)i=a;else if(null==i||null!=a&&i.type!==a.type){this.clearQuery();return}let{type:u,typeInfo:d,query:c}=i,f=t||e&&(this.state.query?.queryText!==c||this.state.query?.typeInfo!==d),p=l.IncludeStickersInAutocomplete.getSetting();n.allowStickers=n.allowStickers?p:n.allowStickers;let{results:m,metadata:h}=d.queryResults(this.props.channel,this.props.guild,c,n,f),E=0;for(let e of Object.values(m))Array.isArray(e)&&(E+=e.length);let _=!0===m.isLoading,I=this.shouldShow(E,_,d),C=this.state.selectedIndex;!I||_?C=null:null!=C&&C>=E&&(C=E-1),I&&!this.state.isVisible&&(0,s.trackAutocompleteOpen)(u,this.props.channel,h),this.setState({query:{type:u,typeInfo:d,queryText:c,results:m,resultCount:E,options:n,isLoading:_},isVisible:I,selectedIndex:C})}shouldShow(e,t,n){return this.props.focused&&null==this.props.expressionPickerView&&(e>0||t||n.showEmpty)}selectResult(e,t,n){if(!this.state.isVisible)return!1;let{type:i,typeInfo:a,results:l,resultCount:o,options:u}=this.state.query;if(e>=o)return!1;let d=a.onSelect?.({results:l,index:e,type:t?r.SelectType.SEND:r.SelectType.INSERT,options:u,channel:this.props.channel,tabOrEnter:n,queryText:this.state.query?.queryText});return null!=d&&(0,s.trackAutocompleteSelect)(i,d.type??null,this.props.channel,d.metadata),!0}setState(e){for(let t in e)if(e[t]!==this.state[t]){this.state={...this.state,...e},this.emit(\"change\",this.state);return}}}"
    }
}