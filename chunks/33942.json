{
    "exports": {
        "OAuth2AuthorizePage": "function X(){let e=(0,u.useLocation)(),t=d.useMemo(()=>(0,V.parseOAuth2AuthorizeProps)(e.search),[e.search]);return(0,T.default)(),(0,o.jsx)(x.OAuth2Page,{children:(0,o.jsx)(Z,{...t,showLogout:!0})})}",
        "OAuth2AuthorizeModal": "function Q(e){let{transitionState:t,...n}=e;return(0,o.jsx)(x.OAuth2Modal,{transitionState:t,\"aria-labelledby\":q,children:(0,o.jsx)(Z,{...n,scrollable:!0})})}",
        "OAuth2Authorize": "function Z(e){let{scrollable:t,...n}=e,{header:s,body:i,footer:r,nextStep:a,appDetails:d}=J(n),u=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(\"div\",{className:z.content,children:[s,i,null==a?d:null]}),r]});return t?(0,o.jsx)(\"div\",{className:z.authorize,children:(0,o.jsx)(h.ScrollerThin,{orientation:\"auto\",children:u})}):(0,o.jsx)(\"div\",{className:z.authorize,children:(0,o.jsx)(\"div\",{children:u})})}",
        "useOAuth2AuthorizeForm": "function J(e){var t,n,s,i,r,a,l,m;let h,T,I,{clientId:S,scopes:x,responseType:X,redirectUri:Q,codeChallenge:Z,codeChallengeMethod:J,state:$,guildId:ee,channelId:et,permissions:en,prompt:es,disableGuildSelect:ei,showLogout:er=!1,authorization:ea,callback:eo,callbackWithoutPost:ed,onClose:eu,cancelCompletesFlow:el=!0,isTrustedName:ef=!1,isEmbeddedFlow:e_=!1,userInstall:ec=!1}=e,eg=d.useMemo(()=>(0,V.filterScopes)(x),[x]),em=(0,u.useLocation)(),eh=C.default.useExperiment({location:\"auth web\"}),ev=eh.userAppsTreatment===C.UserAppsTreatment.ALLOWED;!ev&&(ec=!1);let[eE,ep]=d.useState(0),[ey,eT]=d.useState(null),[eC,eI]=d.useState(P.default.NONE),[eS,eA]=d.useState(1),[eD,eN]=d.useState(null),[eO]=d.useState(w.OrderedAccountScopes.filter(e=>eg.includes(e))),[eP,eb]=d.useState(null!=ee?ee:null),[eV,eR]=d.useState(null!=et?et:null),[ek,eM]=d.useState(!1),ew=d.useMemo(()=>{var e;return null==ey?void 0:null===(e=ey.guilds)||void 0===e?void 0:e.find(e=>e.id===eP)},[null==ey?void 0:ey.guilds,eP]),eL=(0,c.useStateFromStores)([p.default],()=>p.default.getCurrentEmbeddedActivity()),eU=(0,c.useStateFromStoresObject)([E.default,p.default],()=>{let e;let t=E.default.getIsEnabled();if((0,O.isNotNullish)(eL)){if(e=p.default.getShelfActivities(eL.guildId).find(e=>e.application_id===eL.applicationId),t&&void 0===e){var n;e=null===(n=E.default.getDeveloperShelfItems().find(e=>e.id===eL.applicationId))||void 0===n?void 0:n.embeddedActivityConfig}if((0,O.isNotNullish)(e))return{...K.DEFAULT_EMBEDDED_ACTIVITY_CONFIG,...e}}return{}},[eL]),eG=Object.keys(eU).length>0?eU:null,eF=d.useCallback(async e=>{if(null!=ed){ed(e);return}if(!e&&!el){null!=eo&&(eo({application:null==ey?void 0:ey.application,guild:ew}),null==eu||eu());return}try{eM(!0);let t=await (0,R.authorize)({authorize:e,clientId:S,scopes:eg,responseType:X,redirectUri:Q,codeChallenge:Z,codeChallengeMethod:J,state:$,permissions:_.default.remove(null!=en?en:P.default.NONE,eC),guildId:null==eP||ec?void 0:eP,channelId:null!=eV?eV:void 0,userInstall:ec});if(null!=eo)eo({application:null==ey?void 0:ey.application,location:t.location,guild:ew}),null==eu||eu();else if(null!=t.location){let{host:e,path:n}=f.parse(t.location);b.default.isDiscordHostname(e)&&n===j.Routes.OAUTH2_AUTHORIZED?(0,A.transitionTo)(j.Routes.OAUTH2_AUTHORIZED,{state:{application:null==ey?void 0:ey.application,guild:ew}}):window.location=t.location}else eM(!1)}catch(t){let e=t.body;(null==e?void 0:e.message)!=null&&\"\"!==e.message?eN(Error(e.message)):eN(e),eA(1),ep(2),eM(!1)}},[eo,ed,S,Z,J,eC,eu,en,Q,X,eg,eP,eV,$,el,null==ey?void 0:ey.application,ew,ec]),eH=d.useRef(!1),eB=d.useCallback(async()=>{if(0===eE){if(ep(1),!N.default.isAuthenticated()){(0,R.logoutWithRedirect)(em);return}if(!eH.current){eH.current=!0;try{let e=null!=ea?ea:await (0,R.fetchAuthorization)({clientId:S,scopes:eg,responseType:X,redirectUri:Q,codeChallenge:Z,codeChallengeMethod:J,state:$,userInstall:ev&&ec});eT((0,k.convertOAuth2Authorization)(e)),es===L.OAuth2Prompts.NONE&&e.authorized?eF(!0):ep(2),(0,y.trackWithMetadata)(j.AnalyticEvents.OAUTH2_AUTHORIZE_VIEWED,{application_id:e.application.id})}catch(n){let{status:e,body:t}=n;if(401===e){(0,R.logoutWithRedirect)(em);return}eN(Error(null!=t.message?t.message:\"\".concat(Object.keys(t)[0],\": \").concat(Object.values(t)[0]))),ep(2)}finally{eH.current=!1}}}},[ea,S,Z,J,eE,em,es,Q,X,eg,eF,$,ec,ev]),ex=d.useCallback((e,t)=>{eI(n=>e?_.default.remove(n,t):_.default.add(n,t))},[]);d.useEffect(()=>{let e=eg.filter(e=>!w.ValidScopes.includes(e));0===eg.length?(eN(Error(\"No scopes were provided.\")),ep(2)):e.length>0?(eN(Error(\"Invalid scope: \".concat(e[0]))),ep(2)):(0,M.containsDisallowedPermission)(null!=en?en:P.default.NONE)?(eN(Error(\"Invalid permission(s) provided.\")),ep(2)):eB()},[eB,eg,en]);let eY=null!=eV?null==ey?void 0:null===(t=ey.channels)||void 0===t?void 0:t.find(e=>e.id===eV):null,ej=null!=eP?null==ey?void 0:null===(n=ey.guilds)||void 0===n?void 0:n.find(e=>e.id===eP):null;if(d.useEffect(()=>{null!=ey&&(null!=eY?eb(null):null==ej&&(eb(null),eR(null)))},[ey,ej,eY]),eD instanceof Error)return{body:(0,o.jsx)(Y.OAuth2Error,{message:eD.message})};if(2!==eE||null==ey)return{body:(0,o.jsx)(v.Spinner,{})};let eK=new D.default(ey.user),eW=null===(s=ey.bot)||void 0===s?void 0:s.approximate_guild_count,ez=!1;switch(eS){case 1:let eq=null==eD||eD instanceof Error?{}:eD,eX=null===(i=ey.guilds)||void 0===i?void 0:i.sort((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase())),eQ=eg.includes(j.OAuth2Scopes.BOT)||eg.includes(j.OAuth2Scopes.WEBHOOK_INCOMING)||eg.includes(j.OAuth2Scopes.APPLICATIONS_COMMANDS);h=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(G.default,{application:ey.application,accountScopes:eO,errors:eq,isTrustedName:ef}),null==eY&&eQ&&!ec?(0,o.jsx)(H.GuildSelector,{error:(null!==(a=null!==(r=eq[j.OAuth2Scopes.BOT])&&void 0!==r?r:eq[j.OAuth2Scopes.APPLICATIONS_COMMANDS])&&void 0!==a?a:[])[0],selectedGuildId:eP,onGuildChange:e=>{eb(e)},guilds:null!=eX?eX:[],disabled:\"\"!==eP&&!0===ei}):null,eg.includes(j.OAuth2Scopes.WEBHOOK_INCOMING)?(0,o.jsx)(H.WebhookGuildChannelSelector,{error:(null!==(l=eq[j.OAuth2Scopes.WEBHOOK_INCOMING])&&void 0!==l?l:[])[0],selectedChannelId:eV,selectedGuildId:eP,onChannelChange:e=>eR(e)}):null]}),eg.includes(j.OAuth2Scopes.BOT)&&!_.default.equals(en,P.default.NONE)&&(I=2);let eZ=null!=ej&&eg.includes(j.OAuth2Scopes.WEBHOOK_INCOMING)&&null==eV;ez=!ec&&(eQ&&null==ej&&null==eY||eZ);break;case 2:h=(0,o.jsx)(F.default,{application:ey.application,permissions:null!=en?en:P.default.NONE,deniedPermissions:eC,onPermissionsChange:ex,guild:ej}),T=1}let eJ=(0,o.jsx)(U.default,{embeddedActivityConfig:eG,application:ey.application,scopes:eg,redirectUri:null!==(m=ey.redirect_uri)&&void 0!==m?m:null,approximateGuildCount:void 0!==eW?eW:null,isEmbeddedFlow:e_}),e$=(0,o.jsxs)(\"div\",{className:z.footer,children:[null!=T?(0,o.jsx)(g.Button,{look:g.Button.Looks.LINK,color:g.Button.Colors.PRIMARY,onClick:()=>eA(T),children:W.default.Messages.BACK}):(0,o.jsx)(g.Button,{look:g.Button.Looks.LINK,color:g.Button.Colors.PRIMARY,onClick:()=>eF(!1),children:W.default.Messages.CANCEL}),null!=I?(0,o.jsx)(g.Button,{onClick:()=>eA(I),disabled:ez,children:W.default.Messages.CONTINUE}):(0,o.jsx)(g.Button,{onClick:()=>eF(!0),disabled:ez,submitting:ek,children:W.default.Messages.AUTHORIZE})]}),e1=(0,o.jsx)(B.default,{id:q,user:eK,application:ey.application,bot:ey.bot,accountScopes:eO,showLogout:er||!1,location:em,isTrustedName:ef});return{header:e1,body:h,footer:e$,nextStep:I,appDetails:eJ,sendAuthorize:eF}}",
        "openOAuth2ModalWithCreateGuildModal": "function ee(e,t){if((0,S.isMidjourneyOnboardingFlow)(\"create-guild-and-oauth2-modal\")){I.default.openCreateGuildModal({onSuccess:n=>et({...e,guildId:n},t)});return}et(e,t)}",
        "openOAuth2Modal": "function et(e,t){(0,m.openModal)(t=>(0,o.jsx)(Q,{...t,...e,cancelCompletesFlow:!1,callback:$.bind(null,e.callback)}),{onCloseCallback:t})}",
        "getOAuth2AuthorizeProps": "function en(e){let{hostname:t=\"\",host:n,path:s,query:i}=f.parse(e);return null!=s&&null!=i&&(b.default.isDiscordHostname(t)||n===window.location.host)&&(s.startsWith(\"/api\".concat(j.Endpoints.OAUTH2_AUTHORIZE))||s.startsWith(j.Routes.OAUTH2_AUTHORIZE))?(0,V.parseOAuth2AuthorizeProps)(i):null}"
    }
}