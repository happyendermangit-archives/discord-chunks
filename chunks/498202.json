{
    "exports": {
        "OAuth2Authorize": "function X(e){let{scrollable:t,...n}=e,{header:s,body:i,footer:r,nextStep:a,appDetails:u}=Q(n),d=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(\"div\",{className:W.content,children:[s,i,null==a?u:null]}),r]});return t?(0,o.jsx)(\"div\",{className:W.authorize,children:(0,o.jsx)(m.ScrollerThin,{orientation:\"auto\",children:d})}):(0,o.jsx)(\"div\",{className:W.authorize,children:(0,o.jsx)(\"div\",{children:d})})}",
        "OAuth2AuthorizeModal": "function q(e){let{transitionState:t,...n}=e;return(0,o.jsx)(H.OAuth2Modal,{transitionState:t,\"aria-labelledby\":z,children:(0,o.jsx)(X,{...n,scrollable:!0})})}",
        "OAuth2AuthorizePage": "function $(){let e=(0,d.useLocation)(),t=u.useMemo(()=>(0,P.parseOAuth2AuthorizeProps)(e.search),[e.search]);return(0,y.default)(),(0,o.jsx)(H.OAuth2Page,{children:(0,o.jsx)(X,{...t,showLogout:!0})})}",
        "getOAuth2AuthorizeProps": "function et(e){let{hostname:t=\"\",host:n,path:s,query:i}=l.parse(e);return null!=s&&null!=i&&(R.default.isDiscordHostname(t)||n===window.location.host)&&(s.startsWith(`/api${Y.Endpoints.OAUTH2_AUTHORIZE}`)||s.startsWith(Y.Routes.OAUTH2_AUTHORIZE))?(0,P.parseOAuth2AuthorizeProps)(i):null}",
        "openOAuth2Modal": "function ee(e,t){(0,g.openModal)(t=>(0,o.jsx)(q,{...t,...e,cancelCompletesFlow:!1,callback:Z.bind(null,e.callback)}),{onCloseCallback:t})}",
        "openOAuth2ModalWithCreateGuildModal": "function J(e,t){if((0,S.isMidjourneyOnboardingFlow)(\"create-guild-and-oauth2-modal\")){T.default.openCreateGuildModal({onSuccess:n=>ee({...e,guildId:n},t)});return}ee(e,t)}",
        "useOAuth2AuthorizeForm": "function Q(e){let t,n,s,{clientId:i,scopes:r,responseType:a,redirectUri:g,codeChallenge:m,codeChallengeMethod:y,state:T,guildId:S,channelId:H,permissions:$,prompt:q,disableGuildSelect:X,showLogout:Q=!1,authorization:Z,callback:J,callbackWithoutPost:ee,onClose:et,cancelCompletesFlow:en=!0,isTrustedName:es=!1,isEmbeddedFlow:ei=!1,userInstall:er=!1}=e,ea=u.useMemo(()=>(0,P.filterScopes)(r),[r]),eo=(0,d.useLocation)(),eu=I.default.useExperiment({location:\"auth web\"}).userAppsTreatment===I.UserAppsTreatment.ALLOWED;!eu&&(er=!1);let[ed,el]=u.useState(0),[ef,e_]=u.useState(null),[ec,eg]=u.useState(O.default.NONE),[em,eh]=u.useState(1),[eE,ep]=u.useState(null),[ev]=u.useState(V.OrderedAccountScopes.filter(e=>ea.includes(e))),[ey,eI]=u.useState(S??null),[eT,eS]=u.useState(H??null),[eC,eA]=u.useState(!1),eN=u.useMemo(()=>ef?.guilds?.find(e=>e.id===ey),[ef?.guilds,ey]),eD=(0,_.useStateFromStores)([p.default],()=>p.default.getCurrentEmbeddedActivity()),eO=(0,_.useStateFromStoresObject)([E.default,p.default],()=>{let e;let t=E.default.getIsEnabled();return(0,D.isNotNullish)(eD)&&(e=p.default.getShelfActivities(eD.guildId).find(e=>e.application_id===eD.applicationId),t&&void 0===e&&(e=E.default.getDeveloperShelfItems().find(e=>e.id===eD.applicationId)?.embeddedActivityConfig),(0,D.isNotNullish)(e))?{...j.DEFAULT_EMBEDDED_ACTIVITY_CONFIG,...e}:{}},[eD]),eR=Object.keys(eO).length>0?eO:null,eP=u.useCallback(async e=>{if(null!=ee){ee(e);return}if(!e&&!en){null!=J&&(J({application:ef?.application,guild:eN}),et?.());return}try{eA(!0);let t=await (0,b.authorize)({authorize:e,clientId:i,scopes:ea,responseType:a,redirectUri:g,codeChallenge:m,codeChallengeMethod:y,state:T,permissions:f.default.remove($??O.default.NONE,ec),guildId:null==ey||er?void 0:ey,channelId:null!=eT?eT:void 0,userInstall:er});if(null!=J)J({application:ef?.application,location:t.location,guild:eN}),et?.();else if(null!=t.location){let{host:e,path:n}=l.parse(t.location);R.default.isDiscordHostname(e)&&n===Y.Routes.OAUTH2_AUTHORIZED?(0,C.transitionTo)(Y.Routes.OAUTH2_AUTHORIZED,{state:{application:ef?.application,guild:eN}}):window.location=t.location}else eA(!1)}catch(t){let e=t.body;e?.message!=null&&\"\"!==e.message?ep(Error(e.message)):ep(e),eh(1),el(2),eA(!1)}},[J,ee,i,m,y,ec,et,$,g,a,ea,ey,eT,T,en,ef?.application,eN,er]),eb=u.useRef(!1),eM=u.useCallback(async()=>{if(0===ed){if(el(1),!N.default.isAuthenticated()){(0,b.logoutWithRedirect)(eo);return}if(!eb.current){eb.current=!0;try{let e=null!=Z?Z:await (0,b.fetchAuthorization)({clientId:i,scopes:ea,responseType:a,redirectUri:g,codeChallenge:m,codeChallengeMethod:y,state:T,userInstall:eu&&er});e_((0,M.convertOAuth2Authorization)(e)),q===k.OAuth2Prompts.NONE&&e.authorized?eP(!0):el(2),(0,v.trackWithMetadata)(Y.AnalyticEvents.OAUTH2_AUTHORIZE_VIEWED,{application_id:e.application.id})}catch(n){let{status:e,body:t}=n;if(401===e){(0,b.logoutWithRedirect)(eo);return}ep(Error(null!=t.message?t.message:`${Object.keys(t)[0]}: ${Object.values(t)[0]}`)),el(2)}finally{eb.current=!1}}}},[Z,i,m,y,ed,eo,q,g,a,ea,eP,T,er,eu]),eL=u.useCallback((e,t)=>{eg(n=>e?f.default.remove(n,t):f.default.add(n,t))},[]);u.useEffect(()=>{let e=ea.filter(e=>!V.ValidScopes.includes(e));0===ea.length?(ep(Error(\"No scopes were provided.\")),el(2)):e.length>0?(ep(Error(`Invalid scope: ${e[0]}`)),el(2)):(0,L.containsDisallowedPermission)($??O.default.NONE)?(ep(Error(\"Invalid permission(s) provided.\")),el(2)):eM()},[eM,ea,$]);let eV=null!=eT?ef?.channels?.find(e=>e.id===eT):null,ek=null!=ey?ef?.guilds?.find(e=>e.id===ey):null;if(u.useEffect(()=>{null!=ef&&(null!=eV?eI(null):null==ek&&(eI(null),eS(null)))},[ef,ek,eV]),eE instanceof Error)return{body:(0,o.jsx)(x.OAuth2Error,{message:eE.message})};if(2!==ed||null==ef)return{body:(0,o.jsx)(h.Spinner,{})};let ew=new A.default(ef.user),eU=ef.bot?.approximate_guild_count,eG=!1;switch(em){case 1:let eF=null==eE||eE instanceof Error?{}:eE,eB=ef.guilds?.sort((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase())),eH=ea.includes(Y.OAuth2Scopes.BOT)||ea.includes(Y.OAuth2Scopes.WEBHOOK_INCOMING)||ea.includes(Y.OAuth2Scopes.APPLICATIONS_COMMANDS);t=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(U.default,{application:ef.application,accountScopes:ev,errors:eF,isTrustedName:es}),null==eV&&eH&&!er?(0,o.jsx)(F.GuildSelector,{error:(eF[Y.OAuth2Scopes.BOT]??eF[Y.OAuth2Scopes.APPLICATIONS_COMMANDS]??[])[0],selectedGuildId:ey,onGuildChange:e=>{eI(e)},guilds:eB??[],disabled:\"\"!==ey&&!0===X}):null,ea.includes(Y.OAuth2Scopes.WEBHOOK_INCOMING)?(0,o.jsx)(F.WebhookGuildChannelSelector,{error:(eF[Y.OAuth2Scopes.WEBHOOK_INCOMING]??[])[0],selectedChannelId:eT,selectedGuildId:ey,onChannelChange:e=>eS(e)}):null]}),ea.includes(Y.OAuth2Scopes.BOT)&&!f.default.equals($,O.default.NONE)&&(s=2);let ex=null!=ek&&ea.includes(Y.OAuth2Scopes.WEBHOOK_INCOMING)&&null==eT;eG=!er&&(eH&&null==ek&&null==eV||ex);break;case 2:t=(0,o.jsx)(G.default,{application:ef.application,permissions:$??O.default.NONE,deniedPermissions:ec,onPermissionsChange:eL,guild:ek}),n=1}let eY=(0,o.jsx)(w.default,{embeddedActivityConfig:eR,application:ef.application,scopes:ea,redirectUri:ef.redirect_uri??null,approximateGuildCount:void 0!==eU?eU:null,isEmbeddedFlow:ei}),ej=(0,o.jsxs)(\"div\",{className:W.footer,children:[null!=n?(0,o.jsx)(c.Button,{look:c.Button.Looks.LINK,color:c.Button.Colors.PRIMARY,onClick:()=>eh(n),children:K.default.Messages.BACK}):(0,o.jsx)(c.Button,{look:c.Button.Looks.LINK,color:c.Button.Colors.PRIMARY,onClick:()=>eP(!1),children:K.default.Messages.CANCEL}),null!=s?(0,o.jsx)(c.Button,{onClick:()=>eh(s),disabled:eG,children:K.default.Messages.CONTINUE}):(0,o.jsx)(c.Button,{onClick:()=>eP(!0),disabled:eG,submitting:eC,children:K.default.Messages.AUTHORIZE})]});return{header:(0,o.jsx)(B.default,{id:z,user:ew,application:ef.application,bot:ef.bot,accountScopes:ev,showLogout:Q||!1,location:eo,isTrustedName:es}),body:t,footer:ej,nextStep:s,appDetails:eY,sendAuthorize:eP}}"
    }
}