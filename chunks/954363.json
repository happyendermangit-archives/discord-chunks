{
    "exports": {
        "default": "class b extends a.Component{constructor(e){var t;super(e),t=this,this.ref=a.createRef(),this._focusBlurQueue=Promise.resolve(),this.handleSelectionChange=()=>{this.props.focused&&this.props.onSelectionChanged(document.getSelection?.()?.toString())},this.focus=()=>{this._focusBlurQueue?.then(()=>{this.setState({focused:!0},()=>{let e=this.ref.current;null!=e&&e.focus()})})},this.saveCurrentText=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{type:n,channel:i}=t.props;n.drafts.autoSave&&(e&&t.saveCurrentTextThrottled.cancel(),t.handleSaveCurrentText(i.id))},this.handleBeforeUnload=()=>this.saveCurrentText(),this.saveCurrentTextThrottled=o().throttle(this.saveCurrentText.bind(this,!1),500),this.handleEnter=e=>this.props.onEnter?.(e),this.handleTab=()=>this.props.onTab?.(),this.handleMoveSelection=e=>this.props.onMoveSelection?.(e),this.maybeShowAutocomplete=()=>this.props.onMaybeShowAutocomplete?.(),this.hideAutocomplete=()=>this.props.onHideAutocomplete?.(),this.handleSaveCurrentText=e=>{p.default.saveDraft(e,this.props.textValue,this.props.type.drafts.type)},this.handleClearText=()=>{this.props.onChange?.(null,\"\",x.toRichValue(\"\"))},this.handleInsertText=e=>{let{plainText:t,rawText:n,addSpace:i=!1}=e;!this.props.disabled&&(this.appendText(t,n,i),this.focus())},this.handleFocus=e=>{let{onFocus:t}=this.props,{focused:n}=this.state;t?.(e),!n&&this.setState({focused:!0})},this.handleBlur=e=>{let{onBlur:t}=this.props,{focused:n}=this.state;t?.(e),n&&this.setState({focused:!1})},this.handlePaste=e=>{let{channel:t,canPasteFiles:n,uploadPromptCharacterCount:i,promptToUpload:a,maxCharacterCount:s,type:l}=this.props;if(null==a||!t.isPrivate()&&!n||t.isPrivate()&&t.isManaged())return!1;let{files:r}=function(e,t){let n=[],i=[],a=null,s=null;for(let t of e.items)if(\"file\"===t.kind){let e=t.getAsFile();if(null==e)continue;null!=e.path&&e.path.length>0?n.push(e):i.push(e)}else\"string\"===t.kind&&(\"text/plain\"===t.type&&null==a?a=t:\"text/html\"===t.type&&null==s&&(s=t));if(n.length>0)return{files:n};if(i.length>0){if(1===i.length&&\"image/png\"===i[0].type&&null!=s){let t=i[0],n=function(e){let t=new DOMParser().parseFromString(e,\"text/html\").querySelector(\"img\");if(null!=t){let e;try{let{pathname:n}=c.parse(t.src);null!=n&&n.length>0&&(e=d().basename(n).split(\".\")[0])}catch(e){}if(null!=e&&e.length>0)return`${e}.png`}}(e.getData(s.type))??t.name;return{files:[(0,S.makeFile)(t,n,t.type)]}}return{files:i}}if(null!=a&&null!=t){let n=e.getData(a.type);if(n.length>t){let e=new Blob([n],{type:\"text/plain\"});return{files:[(0,S.makeFile)(e,\"message.txt\")],convertedStringToFile:!0}}}return{files:[]}}(e.clipboardData,l.uploadLongMessages?i??s:null);return L(\"onPaste\",[...e.clipboardData.items].map(e=>{if(\"file\"!==e.kind)return{kind:e.kind,type:e.type};{let t=e.getAsFile();return{kind:e.kind,type:e.type,name:t?.name,path:t?.path}}})),0!==r.length&&(e.preventDefault(),e.stopPropagation(),this.saveCurrentText(),((e,n)=>{let i=_.default.getActiveCommand(t.id);if(null==i)return a(e,t,l.drafts.type,{requireConfirm:!0,showLargeMessageDialog:void 0});let s=l.drafts.commandType??l.drafts.type,r=null,o=_.default.getActiveOption(t.id);null!=(r=o?.type===h.ApplicationCommandOptionType.ATTACHMENT?o:i.options?.find(e=>{if(e.type===h.ApplicationCommandOptionType.ATTACHMENT)return null==C.default.getUpload(t.id,e.name,s)}))&&m.default.setFile({channelId:t.id,id:r.name,draftType:s,file:{id:r.name,platform:E.UploadPlatform.WEB,file:e[0]}})})(r),this.focus(),!0)},this._unsubscribe=T.channelEditorPopupStore.subscribe(e=>{requestAnimationFrame(()=>{this.setState({popup:e})})}),this.state={focused:!1,submitting:!1,popup:T.channelEditorPopupStore.getState()}}componentDidMount(){this.props.focused&&requestAnimationFrame(()=>this.focus()),document.addEventListener(\"selectionchange\",this.handleSelectionChange),window.addEventListener(\"beforeunload\",this.handleBeforeUnload)}componentDidUpdate(e){if(this.fixFocus(e),this.props.useSlate!==e.useSlate){let e;e=this.props.useSlate?this.props.textValue:(0,O.toTextValue)(this.props.richValue,{mode:\"plain\"}),this.props.onChange?.(null,e,x.toRichValue(e))}else this.props.textValue!==e.textValue&&this.saveCurrentTextThrottled()}componentWillUnmount(){this.saveCurrentText(),this._unsubscribe?.(),window.removeEventListener(\"beforeunload\",this.handleBeforeUnload),document.removeEventListener(\"selectionchange\",this.handleSelectionChange),this._focusBlurQueue=null,this._unsubscribe=null}blur(){let e=this.ref.current;null!=e&&e.blur()}submit(e){this.ref.current?.submit(e)}insertEmoji(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{textValue:i}=this.props,a=this.ref.current;null!=e&&null!=a&&(n&&!i.endsWith(\" \")&&a.insertText(\" \",void 0,!1),a.insertEmoji(e,t),t&&this.focus())}insertGIF(e){let{textValue:t}=this.props,n=this.ref.current;null!=e&&null!=n&&(!t.endsWith(\" \")&&n.insertText(\" \",void 0,!1),n.insertText(e.url))}insertSound(e){let{textValue:t}=this.props,n=this.ref.current;null!=e&&null!=n&&(!t.endsWith(\" \")&&n.insertText(\" \",void 0,!1),n.insertText(\"<sound:\"+e.soundId+\">\"))}handleOuterClick(){this.focus()}clearValue(){let{channel:e,type:t}=this.props;this.setState({focused:!0,submitting:!1}),p.default.saveDraft(e.id,\"\",t.drafts.type)}getCurrentWord(){let e=this.ref.current;return e?.getCurrentWord()??{word:null,isAtStart:!1}}insertAutocomplete(e,t,n){let i=this.ref.current;return i?.insertAutocomplete(e,t,n)}getCurrentCommandOption(){let e=this.ref.current;return e?.getCurrentCommandOption?.()??null}getCurrentCommandOptionValue(){let e=this.ref.current;return e?.getCurrentCommandOptionValue?.()??[]}getCommandOptionValues(){let e=this.ref.current;return e?.getCommandOptionValues?.()??{}}getFirstText(){let e=this.ref.current;return e?.getFirstText()??null}getSlateEditor(){let e=this.ref.current;return e?.getSlateEditor?.()??null}fixFocus(e){e.focused&&!this.props.focused?this.blur():!e.focused&&this.props.focused&&this.focus()}appendText(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];this.ref.current?.insertText(e,t,n)}getPlaceholder(){let{disabled:e,placeholder:t,isPreviewing:n}=this.props;return e&&!n?M.default.Messages.NO_SEND_MESSAGES_PERMISSION_PLACEHOLDER:t}render(){let{textValue:e,richValue:t,disabled:n,onChange:a,onKeyDown:s,onResize:r,onSubmit:o,channel:u,type:d,fontSize:c,useSlate:p,spellcheckEnabled:m,useNewSlashCommands:h,canOnlyUseTextCommands:E,className:_,id:I,required:C,maxCharacterCount:S,allowNewLines:T,\"aria-describedby\":O,\"aria-labelledby\":M,accessibilityLabel:L}=this.props,{submitting:b,popup:k}=this.state,D={channel:u,className:l()(_,v.textArea,{[v.textAreaSlate]:p,[v.textAreaDisabled]:n||b}),id:I,placeholder:this.getPlaceholder(),required:C,accessibilityLabel:L,disabled:n||!1,submitting:b,isEdit:d===g.ChatInputTypes.EDIT,onFocus:this.handleFocus,onBlur:this.handleBlur,onPaste:this.handlePaste,onTab:this.handleTab,onEnter:this.handleEnter,moveSelection:this.handleMoveSelection,maybeShowAutocomplete:this.maybeShowAutocomplete,hideAutocomplete:this.hideAutocomplete,allowNewLines:T,onChange:a,onResize:r,onKeyDown:s,onSubmit:o,textAreaPaddingClassName:l()(P[c],{[v.textAreaWithoutAttachmentButton]:d!==g.ChatInputTypes.NORMAL&&d!==g.ChatInputTypes.OVERLAY&&d!==g.ChatInputTypes.THREAD_CREATION&&d!==g.ChatInputTypes.SIDEBAR,[v.textAreaForPostCreation]:d===g.ChatInputTypes.CREATE_FORUM_POST,[v.textAreaCustomGift]:d===g.ChatInputTypes.CUSTOM_GIFT}),spellcheckEnabled:m,useNewSlashCommands:h,disableAutoFocus:f.isMobile||(d.disableAutoFocus??!1),disableEnterToSubmit:d.submit?.disableEnterToSubmit??!1,\"aria-controls\":k.id??void 0,\"aria-haspopup\":\"listbox\",\"aria-expanded\":null!==k.id||void 0,\"aria-activedescendant\":k.activeDescendant??void 0,\"aria-invalid\":e.length>S,\"aria-describedby\":O,\"aria-labelledby\":M,\"aria-autocomplete\":\"list\"},U=p?(0,i.jsx)(N.default,{ref:this.ref,...D,type:d,value:n?(0,x.toRichValue)(\"\"):t,canUseCommands:d.commands?.enabled,canOnlyUseTextCommands:E}):(0,i.jsx)(A.default,{ref:this.ref,...D,value:n?\"\":e});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(y.ComponentAction,{event:R.ComponentActions.INSERT_TEXT,handler:this.handleInsertText}),(0,i.jsx)(y.ComponentAction,{event:R.ComponentActions.CLEAR_TEXT,handler:this.handleClearText}),U]})}}"
    }
}